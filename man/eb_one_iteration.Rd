% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/eb_method.R
\name{eb_one_iteration}
\alias{eb_one_iteration}
\alias{eb_one_iteration.univariate}
\alias{eb_one_iteration.multivariate}
\title{One EB fixed-point iteration (S3 generic)}
\usage{
eb_one_iteration(type, ...)

\method{eb_one_iteration}{univariate}(type, bdat, g_orig, g_old, d_old, mom, ...)

\method{eb_one_iteration}{multivariate}(type, bdat, g_orig, g_old, d_old, mom, ...)
}
\arguments{
\item{type}{An object created by \code{\link{combat_type}} or a character scalar.}

\item{...}{Passed to methods.}

\item{bdat}{List of length \eqn{m}; each element is the standardized data for
one measurement in the same batch (\eqn{n_b \times G}).}

\item{g_orig}{Matrix \eqn{m \times G} of original per-feature mean vectors.}

\item{g_old}{Matrix \eqn{m \times G} of current mean estimates.}

\item{d_old}{Length-\eqn{G} list of \eqn{m \times m} covariance estimates.}

\item{mom}{Hyperparameters list from \code{\link{mom_calculation.multivariate}}.}
}
\value{
A list with updated parameters and a scalar convergence measure
\code{change}.

List with \code{g_new} (length \eqn{G}), \code{d_new} (length \eqn{G}),
and \code{change} (scalar).

List with \code{g_new} (\eqn{m \times G}), \code{d_new} (list of
\eqn{m \times m}), and \code{change} (scalar).
}
\description{
Perform a single iteration updating batch mean(s) \eqn{\gamma} and
variance/covariance \eqn{\delta}, given current values and EB hyperparameters.
}
\details{
Uses helper functions \code{robust_matrix_solver()} and
\code{multi_matrix_transform()} (must be available in the package namespace)
to stabilize inversions and assemble feature-specific matrices.
}
