% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/diag_wrapper.R
\name{mul_test}
\alias{mul_test}
\title{Multivariate batch-effect diagnostics (percent significant)}
\usage{
mul_test(bat, data, covar, model, formula = NULL, ref.batch = NULL, ...)
}
\arguments{
\item{bat}{List of \eqn{m} factors (one per measurement) of length \eqn{n}
giving batch labels.}

\item{data}{List of \eqn{m} numeric \eqn{n \times G} matrices/data frames
(rows = samples, columns = features), one per measurement.}

\item{covar}{List of \eqn{m} data frames of covariates (or \code{NULL} entries).}

\item{model}{A modeling function that accepts \code{formula} and \code{data}
(e.g., \code{stats::lm}, \code{mgcv::gam}, \code{lme4::lmer}).}

\item{formula}{RHS formula for covariates (do not include batch; added internally).}

\item{ref.batch}{Optional reference batch level (forwarded to internal modeling
if applicable).}

\item{...}{Additional arguments forwarded to the modeling function.}
}
\value{
A \code{data.frame} with two columns (characters formatted as percentages):
\code{manova_result} and \code{boxM_result}, giving the percentage of features
with adjusted p-value < 0.05 for MANOVA and Box's M, respectively.
}
\description{
For multiple measurements per feature, fits per-feature models for each
measurement, reshapes residuals with \code{\link{multi_test_reshape}}, and
runs multivariate batch tests per feature block:
\itemize{
\item \strong{MANOVA} on additive residual matrices.
\item \strong{Box's M} on multiplicative residual matrices.
}
Reports the percentage of features with adjusted p-value < 0.05 (Bonferroni
by default).
}
\examples{
set.seed(2)
n <- 60; G <- 8; m <- 2
bat <- replicate(m, factor(rep(letters[1:3], each = n/3)), simplify = FALSE)
data <- replicate(m, {
  X <- matrix(rnorm(n * G), n, G); colnames(X) <- paste0("g", 1:G); X
}, simplify = FALSE)

mul_test(bat, data, covar = replicate(m, NULL, simplify = FALSE), model = lm)

}
\seealso{
\code{\link{diag_model_gen}}, \code{\link{diag_model_summary}},
\code{\link{multi_test_reshape}}, \code{\link{manova_test}},
\code{\link{boxM_test}}
}
