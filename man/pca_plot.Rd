% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/diagnostics.R
\name{pca_plot}
\alias{pca_plot}
\title{PCA scatterplots colored by batch/site}
\usage{
pca_plot(pca_prep_result, type = "within", pc_1 = 1, pc_2 = 2, ellipse = TRUE)
}
\arguments{
\item{pca_prep_result}{The list returned by \code{\link[=pca_prep]{pca_prep()}}.}

\item{type}{For multivariate results, either \code{"within"} (per-measurement
PCs) or \code{"shared"} (shared score space \code{G}). Ignored for univariate results.}

\item{pc_1, pc_2}{Integers giving which principal components to plot on
the x/y axes (default \code{1} and \code{2}).}

\item{ellipse}{Logical; draw 68\% normal ellipses per batch (default \code{TRUE}).}
}
\value{
A \code{ggplot} object you can print or add layers to.
}
\description{
Convenience plotting for the objects returned by \code{\link[=pca_prep]{pca_prep()}}.
Produces 2D PC scatterplots colored by \code{bat}, with optional 68\% ellipses.
}
\details{
\itemize{
\item \strong{When \code{pca_prep_result} came from multivariate input}:
\itemize{
\item \code{type = "within"} (default) plots per-measurement PC scores from \code{F_list}
faceted by measurement.
\item \code{type = "shared"} plots the shared subject score space \code{G} (second-stage PCA).
}
\item \strong{When \code{pca_prep_result} came from univariate input}:
plots the single \code{F_t} score matrix.
}
}
\examples{
\dontrun{
set.seed(2)
n <- 40; G <- 8
X <- matrix(rnorm(n*G), n, G); colnames(X) <- paste0("g",1:G)
b <- factor(rep(LETTERS[1:2], each=n/2))
ppu <- pca_prep(b, X, covar = NULL, model = stats::lm, formula = y ~ 1)
p <- pca_plot(ppu, pc_1 = 1, pc_2 = 2, ellipse = TRUE)
# print(p)

Y1 <- X + matrix(rnorm(n*G, sd=.3), n, G)
Y2 <- X + matrix(rnorm(n*G, sd=.5), n, G)
bats <- list(b, b)
ppm <- pca_prep(bats, list(Y1, Y2), covar = list(NULL,NULL),
                model = stats::lm, formula = y ~ 1)
p_within <- pca_plot(ppm, type = "within")
p_shared <- pca_plot(ppm, type = "shared")
}

}
\seealso{
\code{\link[=pca_prep]{pca_prep()}}, \code{\link[ggplot2:ggplot]{ggplot2::ggplot()}}, \code{\link[ggplot2:stat_ellipse]{ggplot2::stat_ellipse()}}
}
