% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/robust_estimation.R
\name{biweight_midvar}
\alias{biweight_midvar}
\title{Tukey biweight mid-variance (univariate robust variance)}
\usage{
biweight_midvar(data, center = NULL, norm.unbiased = TRUE)
}
\arguments{
\item{data}{Numeric vector.}

\item{center}{Optional numeric center. Defaults to \code{median(data)}.}

\item{norm.unbiased}{Logical; if \code{TRUE} (default), uses
\code{c = 9 / qnorm(0.75)} under
normality. If \code{FALSE}, uses \code{c = 9}.}
}
\value{
A single numeric: robust variance estimate.
}
\description{
Computes a robust variance estimate using Tukey's biweight with
median/MAD centering and scaling. Observations with \eqn{|u_i| \ge 1} receive
zero weight, where \eqn{u_i = (x_i - \mathrm{center})/(c \cdot \mathrm{MAD})}.
}
\details{
Let \eqn{d_i = x_i - \mathrm{center}}, \eqn{\mathrm{MAD} = \mathrm{median}(|d_i|)},
and \eqn{u_i = d_i/(c\,\mathrm{MAD})}. The estimator is
\deqn{\hat{\sigma}^2_{\mathrm{BI}} =
n \cdot \frac{\sum_i \mathbb{1}(|u_i|<1)\, d_i^2 (1-u_i^2)^4}
{\left\{\sum_i \mathbb{1}(|u_i|<1)\, (1-u_i^2)(1-5u_i^2)\right\}^2}.}
}
\note{
If \code{MAD == 0} or the denominator is zero (e.g., all points trimmed),
the result may be \code{NaN}/\code{Inf}. Consider falling back to
\code{var(data)} or adding a small jitter in such edge cases.
}
\examples{
set.seed(1)
x <- c(rnorm(50, 0, 1), 10)  # one outlier
var(x)
biweight_midvar(x)           # robust to the outlier

}
\seealso{
\code{\link[stats]{var}}
}
