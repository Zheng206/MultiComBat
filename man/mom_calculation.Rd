% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/eb_method.R
\name{mom_calculation}
\alias{mom_calculation}
\alias{mom_calculation.univariate}
\alias{mom_calculation.multivariate}
\title{Method-of-moments hyperparameters for EB (S3 generic)}
\usage{
mom_calculation(type, ...)

\method{mom_calculation}{univariate}(type, gamma_hat, delta_hat, ...)

\method{mom_calculation}{multivariate}(type, gamma_hat_batch, delta_hat_batch, ...)
}
\arguments{
\item{type}{An object created by \code{\link{combat_type}} or a character scalar.}

\item{...}{Passed to methods.}

\item{gamma_hat}{Matrix of per-batch means (batches \eqn{\times} features).}

\item{delta_hat}{Matrix of per-batch variances (batches \eqn{\times} features).}

\item{gamma_hat_batch}{An \eqn{m \times G} matrix of batch-wise means
across measurements (rows) and features (columns) for a single batch.}

\item{delta_hat_batch}{Length-\eqn{G} list of \eqn{m \times m} covariance
matrices for that batch.}
}
\value{
Method-specific list of hyperparameters used by \code{\link{eb_one_iteration}}
and \code{\link{eb_algorithm}}.

List with \code{g_bar}, \code{g_var}, \code{d_bar}, \code{d_var},
\code{d_a}, \code{d_b}.

List with \code{g_bar} (\eqn{m}), \code{g_var} (\eqn{m \times m}),
\code{d_bar} (\eqn{m \times m}), \code{d_var} (\eqn{m \times m}),
\code{d_a} (scalar df), \code{d_b} (\eqn{m \times m} scale).
}
\description{
Estimate prior hyperparameters for the EB step from batch-wise summaries.
}
\details{
Univariate method matches moments to a normal prior for \eqn{\gamma} with
mean \code{g_bar} and variance \code{g_var}, and an inverse-gamma prior for
\eqn{\delta} parameterized by \code{d_a}, \code{d_b}.

Multivariate method matches moments to a matrix-normal / inverse-Wishartâ€“like
prior, producing mean vector \code{g_bar} (\eqn{m}), covariance \code{g_var}
(\eqn{m \times m}) for \eqn{\gamma}, and IW parameters \code{d_a} (df)
and \code{d_b} (\eqn{m \times m} scale) for \eqn{\Delta}. Diagnostics
\code{d_var} provide dispersion summaries across features.
}
