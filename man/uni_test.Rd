% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/diag_wrapper.R
\name{uni_test}
\alias{uni_test}
\title{Univariate batch-effect diagnostics (percent significant)}
\usage{
uni_test(
  bat,
  data,
  covar,
  model,
  formula = NULL,
  ref.batch = NULL,
  test_param = list(random = NULL),
  ...
)
}
\arguments{
\item{bat}{Either a factor of length \eqn{n} giving batch labels (univariate
case), or a list of \eqn{m} factors (one per measurement) for the multivariate
input variant.}

\item{data}{Either a numeric \eqn{n \times G} matrix/data frame of responses
(rows = samples, columns = features), or a list of \eqn{m} such matrices
(one per measurement) matching \code{bat} when multivariate inputs are supplied.}

\item{covar}{Data frame of covariates (\eqn{n \times q}), \code{NULL} for a
null model, or a list of data frames if \code{data} is a list.}

\item{model}{A modeling function that accepts \code{formula} and \code{data}
(e.g., \code{stats::lm}, \code{mgcv::gam}, \code{lme4::lmer}).}

\item{formula}{RHS formula for covariates (do not include batch; it is handled
internally when batch adjustment is enabled).}

\item{ref.batch}{Optional reference batch level (forwarded to internal modeling
if applicable).}

\item{test_param}{List of extra arguments passed to
\code{\link{diag_model_summary}} (e.g., \code{list(random = "id")} for mixed models).}

\item{...}{Additional arguments forwarded to the modeling function.}
}
\value{
A \code{data.frame} with five columns containing the percentage (as a
formatted character, e.g. \code{"12.50\%"}) of features called significant for:
ANOVA, Kruskal–Wallis, Levene, Bartlett, and Fligner–Killeen tests.
If \code{data} is a list, each column contains one percentage per measurement.
}
\description{
Fits a per-feature model (via \code{\link{diag_model_gen}}) and summarizes
univariate batch tests on the resulting residuals:
\itemize{
\item Mean-shift: one-way ANOVA and Kruskal–Wallis on additive residuals.
\item Variance-shift: Levene, Bartlett, Fligner–Killeen on multiplicative residuals.
}
For each test, the function reports the percentage of features with adjusted
p-value < 0.05 (the underlying test helpers use Bonferroni by default).
}
\examples{
set.seed(1)
n <- 60; G <- 10
bat <- factor(rep(letters[1:3], each = n/3))
X   <- matrix(rnorm(n * G), n, G); colnames(X) <- paste0("g", 1:G)

# Simple null model per feature (lm with intercept only)
uni_test(bat, data = X, covar = NULL, model = lm)

}
\seealso{
\code{\link{diag_model_gen}}, \code{\link{diag_model_summary}},
\code{\link{anova_test}}, \code{\link{kruskal_test}},
\code{\link{lv_test}}, \code{\link{bl_test}}, \code{\link{fk_test}}
}
