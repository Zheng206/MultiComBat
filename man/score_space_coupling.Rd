% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/covbat.R
\name{score_space_coupling}
\alias{score_space_coupling}
\title{Score-space coupling across multiple blocks}
\usage{
score_space_coupling(
  R_list,
  center = TRUE,
  scale_scores = TRUE,
  var_thresh = 0.95,
  min_rblock = 5,
  max_rblock = Inf
)
}
\arguments{
\item{R_list}{List of length \eqn{m}; each element an \eqn{n \times p_t}
numeric matrix/data frame (rows = subjects, columns = variables for block \emph{t}).
All elements \strong{must} have the same number of rows.}

\item{center}{Logical; center columns before PCA in each block (default \code{TRUE}).}

\item{scale_scores}{Logical; rescale per-block retained scores to unit SD
before concatenation (default \code{TRUE}).}

\item{var_thresh}{Numeric in (0,1]; per-PCA cumulative variance threshold used
by \code{\link[=pick_r_from_pc]{pick_r_from_pc()}} to choose retained dimensions (default \code{0.95}).}

\item{min_rblock}{Integer; minimum PCs per block (default \code{5}).}

\item{max_rblock}{Integer; maximum PCs per block (default \code{Inf}).}
}
\value{
A list with components:
\describe{
\item{G}{\eqn{n \times r_\mathrm{shared}} matrix of shared subject scores from
the second-stage PCA on concatenated scores.}
\item{A_list}{List of block-specific projection matrices \eqn{A_t} of size
\eqn{r_\mathrm{shared} \times r_t} such that
\eqn{F^{(t)}_\mathrm{std} \approx G A_t + H_t}.}
\item{H_list}{List of residual score matrices \eqn{H_t} (\eqn{n \times r_t}).}
\item{F_list}{List of per-block retained scores (\eqn{n \times r_t}).}
\item{F_list_std}{Same as \code{F_list} but column-standardized if \code{scale_scores=TRUE}.}
\item{L_list}{List of per-block PCA loadings (\eqn{p_t \times r_t}).}
\item{sdev_list}{List of per-block retained singular values (length \code{r_t}).}
\item{sc_list}{List of per-block score standardization factors (length \code{r_t}).}
\item{meta}{List with \code{n}, \code{m}, \code{r_shared}, and flags.}
}
}
\description{
For a list of blocks (same subjects/rows), performs:
\enumerate{
\item per-block PCA (keeping a data-driven number of PCs per block),
\item concatenates standardized block scores and runs a second PCA to extract
\emph{shared} subject scores \code{G},
\item projects each block's scores onto the shared space to get block
loadings in score-space \code{A_t} and residual scores \code{H_t}.
}
}
\details{
This is a simple, PCA-based coupling of blocks that exposes common
variation across measurements while allowing block-specific residuals.
}
\examples{
set.seed(2)
n <- 60
R1 <- scale(matrix(rnorm(n*30), n, 30))
R2 <- scale(matrix(rnorm(n*20), n, 20))
fit <- score_space_coupling(list(R1, R2), var_thresh = 0.9, min_rblock = 3)
str(fit$meta)

}
\seealso{
\code{\link[stats:prcomp]{stats::prcomp()}}, \code{\link[=pick_r_from_pc]{pick_r_from_pc()}}, \code{\link[=reconstruct_block]{reconstruct_block()}}
}
