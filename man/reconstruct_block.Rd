% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/covbat.R
\name{reconstruct_block}
\alias{reconstruct_block}
\title{Reconstruct a block back to variable space}
\usage{
reconstruct_block(G, A_t, H_t, L_t, sc_t = NULL)
}
\arguments{
\item{G}{\eqn{n \times r_\mathrm{shared}} matrix of shared scores.}

\item{A_t}{\eqn{r_\mathrm{shared} \times r_t} projection matrix for block \emph{t}.}

\item{H_t}{\eqn{n \times r_t} residual scores for block \emph{t}.}

\item{L_t}{\eqn{p_t \times r_t} PCA loadings (variables by retained PCs) for block \emph{t}.}

\item{sc_t}{Optional length-\eqn{r_t} vector of score scaling factors used
during coupling (if scores were standardized).}
}
\value{
\eqn{n \times p_t} numeric matrix: reconstructed block \emph{t}.
}
\description{
Given shared scores \code{G}, a block's score-space projection \code{A_t}, residual
scores \code{H_t}, and the block loadings \code{L_t}, reconstructs the block in the
original variable space. If score standardization was applied, pass \code{sc_t}
to undo it.
}
\examples{
set.seed(2)
n <- 60
R1 <- scale(matrix(rnorm(n*30), n, 30))
R2 <- scale(matrix(rnorm(n*20), n, 20))
fit <- score_space_coupling(list(R1, R2), var_thresh = 0.9, min_rblock = 3)
result <- reconstruct_block(fit$G, fit$A_list[[1]], fit$H_list[[1]], fit$L_list[[1]],
fit$sc_list[[1]])
}
\seealso{
\code{\link[=score_space_coupling]{score_space_coupling()}}
}
