% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/eb_check.R
\name{eb_diagnostics}
\alias{eb_diagnostics}
\alias{eb_check}
\alias{eb_plot}
\alias{eb_check.univariate}
\alias{eb_plot.univariate}
\alias{eb_check.multivariate}
\alias{eb_plot.multivariate}
\title{Empirical-Bayes diagnostic distributions & plots}
\usage{
eb_check(eb_result, ...)

eb_plot(eb_df, ...)

\method{eb_check}{univariate}(eb_result, ...)

\method{eb_plot}{univariate}(eb_df, ...)

\method{eb_check}{multivariate}(eb_result, ...)

\method{eb_plot}{multivariate}(eb_df, param = "gamma", bat = NULL, ...)
}
\arguments{
\item{eb_result}{An EB result list returned by \code{eb_algorithm()}.}

\item{...}{Passed to methods.}

\item{eb_df}{Output produced by \code{eb_check()} for the corresponding mode.}

\item{param}{Character, either \code{"gamma"} (mean effects) or
\code{"delta"} (covariance/variance diagnostics).}

\item{bat}{Character scalar; when \code{param = "delta"}, choose which batch
to display (required if multiple batches are present).}
}
\value{
For \code{eb_check.univariate}, a list with element \code{eb_df}
(tidy data frame with columns \code{batch}, \code{parm} in \{gamma,delta\},
\code{type} in \{prior,emp.dist\}, and \code{dist} = sampled/empirical values).

For \code{eb_plot.univariate}, a \code{ggplot} object with density
overlays of prior vs empirical per batch, faceted by parameter
(\code{gamma}, \code{delta}).

For \code{eb_check.multivariate}, a list with
\code{eb_gamma} (tidy df of prior/empirical mean draws by measurement) and
\code{eb_delta} (tidy df of distance metrics comparing covariance priors vs
empirical estimates).

For \code{eb_plot.multivariate}, a \code{ggplot} object:
densities for \code{param = "gamma"} (faceted by measurement), or
histograms of distance metrics for \code{param = "delta"} (faceted by metric).
}
\description{
Tools to compare the fitted \strong{empirical distributions} of batch parameters
with their \strong{prior} distributions used by the EB procedure.
}
\details{
\describe{
\item{\code{eb_check()}}{Builds tidy data frames of prior samples and empirical
summaries for plotting.}
\item{\code{eb_plot()}}{Convenience plots (densities/histograms) comparing
prior vs empirical by batch, for either mean effects (\eqn{\gamma}) or
dispersion/covariance (\eqn{\delta}).}
}
}
\section{Univariate EB}{

For each batch \eqn{i}, \code{eb_check.univariate()} draws
\eqn{\gamma_{ig} \sim \mathcal{N}(g\_bar,\; g\_var)} and
\eqn{\delta_{ig} \sim \mathrm{InvGamma}(d\_a,\; d\_b)} (using
\code{MCMCpack::rinvgamma}'s \emph{shape/scale} parameterization),
and collates them with the empirical \code{gamma_hat} / \code{delta_hat}.
}

\section{Multivariate EB}{

For each batch \eqn{i}, \code{eb_check.multivariate()} draws
\eqn{\boldsymbol{\gamma}_{ig} \sim \mathcal{N}_m(g\_bar,\; g\_var)}
via \code{MASS::mvrnorm} and
\eqn{\boldsymbol{\Sigma}_{ig} \sim \mathcal{IW}(\nu, \Psi)} via
\code{MCMCpack::riwish}. It then compares empirical \code{delta_hat} against
the prior by several distances (Frobenius, MSE, spectral, eigen-error, KL).
}

\examples{
\dontrun{
# suppose eb_uni is the output of eb_algorithm(type = combat_type("univariate"), ...)
chk <- eb_check(eb_uni)
p   <- eb_plot(chk)   # densities for gamma & delta
}
}
\keyword{diagnostics}
\keyword{visualization}
