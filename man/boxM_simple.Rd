% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/diagnostics.R
\name{boxM_simple}
\alias{boxM_simple}
\title{Box's M test}
\usage{
boxM_simple(Y, group, ridge = 1e-08)
}
\arguments{
\item{Y}{Numeric matrix \eqn{n \times p} (rows = samples, cols = variables).}

\item{group}{Factor (or coercible) of length n with group labels.}

\item{ridge}{Small diagonal ridge added to each group covariance for
numerical stability (default \code{1e-8}).}
}
\value{
A list with elements \code{statistic},
\code{parameter} (df), \code{p.value}, and \code{method}.
}
\description{
Tests equality of covariance matrices across groups using the
chi-square approximation with Box's small-sample correction.
}
\examples{
set.seed(123)
n <- 60; p <- 3
Z1 <- matrix(rnorm(n * p), n, p)
Z2 <- matrix(rnorm(n * p), n, p)
Sigma2 <- matrix(c(1, 0.6, 0.3,
                   0.6, 1, 0.4,
                   0.3, 0.4, 1), p, p)
Y1 <- Z1
Y2 <- Z2 \%*\% chol(Sigma2)
Y  <- rbind(Y1, Y2)
g  <- factor(rep(c("A","B"), each = n))
out_diff <- boxM_simple(Y, g)
out_diff$p.value


}
